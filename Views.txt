# SENDING FILE TO THE SERVER
scp -i .\couchDB1.pem.txt ..\twitter-place-data.zip ubuntu@172.26.130.94:~

# The servers can access each other

# QUERIES

# To get a reduced view
curl -X GET http://admin:Royai99@127.0.0.1:5984/tweetspart/_design/ddoc/_view/citycount?reduce=true"&"group_level=1

#To get covid tweets wrt date and place
curl -X GET http://admin:Royai99@127.0.0.1:5984/tweetscovid/_design/place/_view/timeplacesentiment?reduce=true"&"group_level=2

#To get covid tweets and aggregate sentiment wrt time and place
curl -X GET http://admin:Royai99@127.0.0.1:5984/tweetscovid/_design/place/_view/timeplace-sentiment?reduce=true"&"group_level=2

#To save the query to a file, do curl -X GET http://admin:Royai99@127.0.0.1:5984/tweetscovid/_design/place/_view/timeplace-sentiment?reduce=true"&"group_level=2 > twitter.json

#VIEWS

#1. To get date, place and sentiment wise data (timeplacesentiment)
function (doc) {
  if(doc.place.full_name){
    var date=doc.time.split('T');
    var sentiment = 'neutral';
    if(doc.sentiment>0){
      sentiment='positive';
    }
    else if(doc.sentiment<0) {
      sentiment='negative';
    }
    emit([date[0], doc.place.full_name, sentiment], 1)
  }
}

#2. Average sentiment (timeplace-sentiment)
function (doc) {
  if(doc.place.full_name){
    var date=doc.time.split('T');
    emit([date[0], doc.place.full_name], doc.sentiment);
  }
}
